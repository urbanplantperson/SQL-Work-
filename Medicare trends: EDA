--- Find most commonly coded procedures in the US, limit top 100 --- 
 SELECT 
  hcpcs_cd,
  COUNT(hcpcs_cd) AS count,
  hcpcs_desc
 FROM medicare_services_2020 
  WHERE rndrng_prvdr_cntry = 'US'
  GROUP BY hcpcs_cd, hcpcs_desc
  ORDER BY count DESC
 LIMIT 100;
hcpcs_cd | count  |   hcpcs_desc                                                                                                                            
----------+--------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 99213    | 460894 | Established patient office or other outpatient visit, typically 15 minutes
 99214    | 449763 | Established patient office or other outpatient, visit typically 25 minutes
 99232    | 172943 | Subsequent hospital inpatient care, typically 25 minutes per day
 99204    | 170977 | New patient office or other outpatient visit, typically 45 minutes
 99203    | 164212 | New patient office or other outpatient visit, typically 30 minutes
 G0008    | 135203 | Administration of influenza virus vaccine
 99223    | 131582 | Initial hospital inpatient care, typically 70 minutes per day
 99233    | 129113 | Subsequent hospital inpatient care, typically 35 minutes per day
 99212    | 113146 | Established patient office or other outpatient visit, typically 10 minutes
 99215    | 112779 | Established patient office or other outpatient, visit typically 40 minutes
 99222    |  98354 | Initial hospital inpatient care, typically 50 minutes per day
 99442    |  98267 | Physician telephone patient service, 11-20 minutes of medical discussion
 G0439    |  92005 | Annual wellness visit, includes a personalized prevention plan of service (pps), subsequent visit
 36415    |  90992 | Insertion of needle into vein for collection of blood sample
 90662    |  86655 | Vaccine for influenza for injection into muscle
 G0009    |  74429 | Administration of pneumococcal vaccine
 93000    |  71059 | Routine ekg using at least 12 leads including interpretation and report
 99291    |  68248 | Critical care delivery critically ill or injured patient, first 30-74 minutes
 97110    |  64572 | Therapeutic exercise to develop strength, endurance, range of motion, and flexibility, each 15 minutes
 99443    |  60810 | Physician telephone patient service, 21-30 minutes of medical discussion
 99284    |  59462 | Emergency department visit, problem of high severity
 96372    |  59204 | Injection beneath the skin or into muscle for therapy, diagnosis, or prevention
 99285    |  58809 | Emergency department visit, problem with significant threat to life or function
 71046    |  57268 | X-ray of chest, 2 views
 99231    |  56635 | Subsequent hospital inpatient care, typically 15 minutes per day
 99239    |  56046 | Hospital discharge day management, more than 30 minutes
 93010    |  55927 | Routine electrocardiogram (ekg) using at least 12 leads with interpretation and report
 99205    |  55602 | New patient office or other outpatient visit, typically 60 minutes
 97140    |  54251 | Manual (physical) therapy techniques to 1 or more regions, each 15 minutes
 90732    |  52471 | Vaccine for pneumococcal polysaccharide for injection beneath the skin or into muscle, patient 2 years or older
 99283    |  49543 | Emergency department visit, moderately severe problem
 81003    |  44561 | Automated urinalysis test
 99441    |  43117 | Physician telephone patient service, 5-10 minutes of medical discussion
 99202    |  42792 | New patient office or other outpatient visit, typically 20 minutes
 83036    |  42782 | Hemoglobin a1c level
 97112    |  42372 | Therapeutic procedure to re-educate brain-to-nerve-to-muscle function, each 15 minutes
 20610    |  41389 | Aspiration and/or injection of large joint or joint capsule
 73030    |  38872 | X-ray of shoulder, minimum of 2 views
 99238    |  38811 | Hospital discharge day management, 30 minutes or less
 97530    |  38619 | Therapeutic activities to improve function, with one-on-one contact between patient and provider, each 15 minutes
 00731    |  37958 | Anesthesia for procedure on esophagus, stomach, and/or upper small bowel using an endoscope
 92014    |  37476 | Eye and medical examination for diagnosis and treatment, established patient, 1 or more visits
 73502    |  37107 | X-ray of hip with pelvis, 2-3 views
 93306    |  36429 | Ultrasound examination of heart including color-depicted blood flow rate, direction, and valve function
 85025    |  34818 | Complete blood cell count (red cells, white blood cell, platelets), automated test
 99308    |  34505 | Subsequent nursing facility visit, typically 15 minutes per day
 90694    |  34250 | Influenza virus vaccine, quadrivalent (aiiv4), inactivated, adjuvanted, preservative free, for injection into muscle, 0.5 ml dosage
 99221    |  34106 | Initial hospital inpatient care, typically 30 minutes per day
 73630    |  34096 | X-ray of foot, minimum of 3 views
 99309    |  33534 | Subsequent nursing facility visit, typically 25 minutes per day
 90686    |  33171 | Vaccine for influenza for administration into muscle, 0.5 ml dosage
 90670    |  32863 | Pneumococcal vaccine for injection into muscle
 81002    |  32812 | Urinalysis, manual test
 99211    |  32158 | Established patient office or other outpatient visit, typically 5 minutes
 72100    |  30644 | X-ray of lower and sacral spine, 2 or 3 views
 J3301    |  30522 | Injection, triamcinolone acetonide, not otherwise specified, 10 mg
 99217    |  29776 | Hospital observation care on day of discharge
 74177    |  29599 | Ct scan of abdomen and pelvis with contrast
 99220    |  29431 | Hospital observation care, typically 70 minutes
 97161    |  27737 | Evaluation of physical therapy, typically 20 minutes
 71250    |  27650 | Ct scan chest
 73562    |  27567 | X-ray of knee, 3 views
 92004    |  27222 | Eye and medical examination for diagnosis and treatment, new patient, 1 or more visits
 97162    |  27103 | Evaluation of physical therapy, typically 30 minutes
: 99202    |  42792 | New patient office or other outpatient visit, typically 20 minutes

--- Find most expensive procedures in US (single procedure, not counting total patients who recieved procedure) --- 
--- surgery seems to be the most expensive procedure, followed by insertion of needle to a dialysis circuit --- 
SELECT
 hcpcd_cd,
 hcpcs_desc,
 avg_mdcr_stdzd_amnt 
FROM medicare_services_2020 
 WHERE rndrng_prvdr_cntry = 'US'
 GROUP BY hcpcs_cd, hcpcs_desc, avg_mdcr_stdzd_amnt 
 ORDER BY avg_mdcr_stdzd_amnt DESC 
 LIMIT 50;
 hcpcs_cd |                                                                               hcpcs_desc                                                                               | avg_mdcr_stdzd_amnt 
----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.99058824
 36902    | Insertion of needle and/or catheter into dialysis circuit and balloon dilation of dialysis segment, with imaging including radiological supervision and interpretation | 999.971875
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.95384615
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.94785714
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.94066667
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.93857143
 27130    | Replacement of thigh bone and hip joint prosthesis                                                                                                                     | 999.93842105
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.91428571
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.89384615
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.88916667
 15736    | Muscle flap wound repair of arm                                                                                                                                        | 999.85950413
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.854
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.83583333
 29881    | Removal of one knee cartilage using an endoscope                                                                                                                       | 999.83454545
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.83210526
 38724    | Removal of lymph nodes, muscle, and tissue of neck                                                                                                                     | 999.82
 29880    | Removal of both knee cartilages using an endoscope                                                                                                                     | 999.80611111
 29881    | Removal of one knee cartilage using an endoscope                                                                                                                       | 999.80611111
 78492    | Multiple nuclear medicine studies of blood flow in heart muscle at rest and with stress                                                                                | 999.79693069
 29880    | Removal of both knee cartilages using an endoscope                                                                                                                     | 999.79611111
 29881    | Removal of one knee cartilage using an endoscope                                                                                                                       | 999.79611111
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.78
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.75590909
 29880    | Removal of both knee cartilages using an endoscope                                                                                                                     | 999.75407407
 29880    | Removal of both knee cartilages using an endoscope                                                                                                                     | 999.75349206
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.74606061
 29881    | Removal of one knee cartilage using an endoscope                                                                                                                       | 999.744
 49505    | Repair of groin hernia patient age 5 years or older                                                                                                                    | 999.74133333
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.73625
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.73606061
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.72733333
 29881    | Removal of one knee cartilage using an endoscope                                                                                                                       | 999.7225
 29881    | Removal of one knee cartilage using an endoscope                                                                                                                       | 999.71928571
 29881    | Removal of one knee cartilage using an endoscope                                                                                                                       | 999.68272727
 A9500    | Technetium tc-99m sestamibi, diagnostic, per study dose                                                                                                                | 999.65646552
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.655625
 26123    | Removal of tissue of palm                                                                                                                                              | 999.65153846
 78492    | Multiple nuclear medicine studies of blood flow in heart muscle at rest and with stress                                                                                | 999.62869565
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.61
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.60647059
 27447    | Repair of knee joint                                                                                                                                                   | 999.60136364
 29881    | Removal of one knee cartilage using an endoscope                                                                                                                       | 999.58727273
 27447    | Repair of knee joint                                                                                                                                                   | 999.56125
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.56071429
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.55642857
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.543125
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.53166667
 65820    | Incision to improve eye fluid flow                                                                                                                                     | 999.51388889
 63042    | Re-exploration of spine repair with release of lower spinal cord or nerves                                                                                             | 999.50461538
 27245    | Surgical treatment of broken thigh bone                                                                                                                                | 999.5
(50 rows)

--- Find most expensive AND most coded services --- not quite but something else... ---
SELECT hcpcs_cd, COUNT(hcpcs_cd) AS count, hcpcs_desc, avg_mdcr_stdzd_amnt 
FROM medicare_services_2020 
WHERE rndrng_prvdr_cntry = 'US' 
GROUP BY hcpcs_cd, hcpcs_desc, avg_mdcr_stdzd_amnt
ORDER BY count DESC
LIMIT 50;
hcpcs_cd | count  |                                                                     hcpcs_desc                                                                     | avg_mdcr_stdzd_amnt 
----------+--------+----------------------------------------------------------------------------------------------------------------------------------------------------+---------------------
 G0008    | 104498 | Administration of influenza virus vaccine                                                                                                          | 14.15
 36415    |  79086 | Insertion of needle into vein for collection of blood sample                                                                                       | 2.94
 G0009    |  65715 | Administration of pneumococcal vaccine                                                                                                             | 14.15
 G0439    |  64222 | Annual wellness visit, includes a personalized prevention plan of service (pps), subsequent visit                                                  | 114.95
 81003    |  40701 | Automated urinalysis test                                                                                                                          | 2.21
 83036    |  38522 | Hemoglobin a1c level                                                                                                                               | 9.52
 99233    |  38021 | Subsequent hospital inpatient care, typically 35 minutes per day                                                                                   | 83.19
 81002    |  30675 | Urinalysis, manual test                                                                                                                            | 3.41
 85025    |  29431 | Complete blood cell count (red cells, white blood cell, platelets), automated test                                                                 | 7.61
 99222    |  25123 | Initial hospital inpatient care, typically 50 minutes per day                                                                                      | 110.06
 90694    |  23494 | Influenza virus vaccine, quadrivalent (aiiv4), inactivated, adjuvanted, preservative free, for injection into muscle, 0.5 ml dosage                | 59.78
 99232    |  23269 | Subsequent hospital inpatient care, typically 25 minutes per day                                                                                   | 57.72
 99232    |  23246 | Subsequent hospital inpatient care, typically 25 minutes per day                                                                                   | 57.71
 99223    |  20770 | Initial hospital inpatient care, typically 70 minutes per day                                                                                      | 161.56
 G0008    |  20049 | Administration of influenza virus vaccine                                                                                                          | 12.03
 99231    |  19395 | Subsequent hospital inpatient care, typically 15 minutes per day                                                                                   | 31.41
 G0439    |  19228 | Annual wellness visit, includes a personalized prevention plan of service (pps), subsequent visit                                                  | 97.7
 84443    |  18129 | Blood test, thyroid stimulating hormone (tsh)                                                                                                      | 16.46
 90662    |  17651 | Vaccine for influenza for injection into muscle                                                                                                    | 59.76
 G0438    |  16802 | Annual wellness visit; includes a personalized prevention plan of service (pps), initial visit                                                     | 169.41
 85610    |  16103 | Blood test, clotting time                                                                                                                          | 4.2
 99238    |  15384 | Hospital discharge day management, 30 minutes or less                                                                                              | 58.29
 G0444    |  15227 | Annual depression screening, 15 minutes                                                                                                            | 18.04
 90686    |  14846 | Vaccine for influenza for administration into muscle, 0.5 ml dosage                                                                                | 19.19
 80053    |  14683 | Blood test, comprehensive group of blood chemicals                                                                                                 | 10.35
 81001    |  13389 | Manual urinalysis test with examination using microscope                                                                                           | 3.11
 80061    |  13084 | Blood test, lipids (cholesterol and triglycerides)                                                                                                 | 13.12
 87804    |  12892 | Detection test for influenza virus                                                                                                                 | 16.22
 99239    |  12839 | Hospital discharge day management, more than 30 minutes                                                                                            | 85.45
 G0101    |  11757 | Cervical or vaginal cancer screening; pelvic and clinical breast examination                                                                       | 39.97
 99223    |  11646 | Initial hospital inpatient care, typically 70 minutes per day                                                                                      | 161.55
 80048    |  11323 | Blood test, basic group of blood chemicals                                                                                                         | 8.29
 82570    |  10760 | Creatinine level to test for kidney function or muscle injury                                                                                      | 5.08
 82306    |  10741 | Vitamin d-3 level                                                                                                                                  | 29.01
 G0402    |  10374 | Initial preventive physical examination; face-to-face visit, services limited to new beneficiary during the first 12 months of medicare enrollment | 165.17
 99221    |  10315 | Initial hospital inpatient care, typically 30 minutes per day                                                                                      | 81.49
 77067    |   9652 | Mammography of both breasts                                                                                                                        | 38.55
 84439    |   9503 | Thyroxine (thyroid chemical) measurement                                                                                                           | 8.84
 82043    |   9326 | Urine microalbumin (protein) level                                                                                                                 | 5.66
 82607    |   9296 | Cyanocobalamin (vitamin b-12) level                                                                                                                | 14.78
 77080    |   9173 | Bone density measurement using dedicated x-ray machine                                                                                             | 9.9
 77063    |   8692 | Screening digital tomography of both breasts                                                                                                       | 30.06
 84153    |   7925 | Psa (prostate specific antigen) measurement                                                                                                        | 18.02
 99291    |   7910 | Critical care delivery critically ill or injured patient, first 30-74 minutes                                                                      | 177.69
 36620    |   7833 | Insertion of arterial catheter for blood sampling or infusion, accessed through the skin                                                           | 36.22
 82728    |   7289 | Ferritin (blood protein) level                                                                                                                     | 13.36
 99442    |   7210 | Physician telephone patient service, 11-20 minutes of medical discussion                                                                           | 59.7
 90682    |   7207 | Vaccine for influenza for injection into muscle                                                                                                    | 59.76
 77080    |   7174 | Bone density measurement using dedicated x-ray machine                                                                                             | 39.26
 76937    |   7164 | Ultrasound guidance for accessing into blood vessel                                                                                                | 11.6
(50 rows)
--- most coded + expensive procedures --- 
SELECT hcpcs_cd, hcpcs_desc, COUNT(hcpcs_cd) AS count, SUM(avg_mdcr_stdzd_amnt::numeric) AS sum 
FROM medicare_services_2020 
WHERE rndrng_prvdr_cntry = 'US'
GROUP BY hcpcs_cd, hcpcs_desc 
ORDER BY count DESC, sum DESC 
LIMIT 50;

hcpcs_cd    hcpcs_desc                                                                                                                             count    sum
 99213    | Established patient office or other outpatient visit, typically 15 minutes                                                          | 460894 | 21425578.6023258833
 99214    | Established patient office or other outpatient, visit typically 25 minutes                                                          | 449763 | 30569085.2331051526
 99232    | Subsequent hospital inpatient care, typically 25 minutes per day                                                                    | 172943 |  9707172.5175780714
 99204    | New patient office or other outpatient visit, typically 45 minutes                                                                  | 170977 | 18651480.1063934040
 99203    | New patient office or other outpatient visit, typically 30 minutes                                                                  | 164212 | 11125751.0240068257
 G0008    | Administration of influenza virus vaccine                                                                                           | 135203 |  1866981.0275779033
 99223    | Initial hospital inpatient care, typically 70 minutes per day                                                                       | 131582 |  20668251.540938505
 99233    | Subsequent hospital inpatient care, typically 35 minutes per day                                                                    | 129113 | 10530633.6816210181
 99212    | Established patient office or other outpatient visit, typically 10 minutes                                                          | 113146 |  3299130.5905095416
 99215    | Established patient office or other outpatient, visit typically 40 minutes                                                          | 112779 | 10925304.6853651544
 99222    | Initial hospital inpatient care, typically 50 minutes per day                                                                       |  98354 |  10441691.641108449
 99442    | Physician telephone patient service, 11-20 minutes of medical discussion                                                            |  98267 |  4882624.5769220279
 G0439    | Annual wellness visit, includes a personalized prevention plan of service (pps), subsequent visit                                   |  92005 | 10219953.0004922072
 36415    | Insertion of needle into vein for collection of blood sample                                                                        |  90992 |   267132.0314064654
 90662    | Vaccine for influenza for injection into muscle                                                                                     |  86655 |  5006178.9779144045
 G0009    | Administration of pneumococcal vaccine                                                                                              |  74429 |  1038953.6564583977
 93000    | Routine ekg using at least 12 leads including interpretation and report                                                             |  71059 |   817181.9439785901
 99291    | Critical care delivery critically ill or injured patient, first 30-74 minutes                                                       |  68248 |   12234509.20333451
 97110    | Therapeutic exercise to develop strength, endurance, range of motion, and flexibility, each 15 minutes                              |  64572 |  1264339.8563412824
 99443    | Physician telephone patient service, 21-30 minutes of medical discussion                                                            |  60810 |  4476283.3478212663
 99284    | Emergency department visit, problem of high severity                                                                                |  59462 |   5186885.234442161
 96372    | Injection beneath the skin or into muscle for therapy, diagnosis, or prevention                                                     |  59204 |   562668.0097307657
 99285    | Emergency department visit, problem with significant threat to life or function                                                     |  58809 |   7908266.687002002
 71046    | X-ray of chest, 2 views                                                                                                             |  57268 |   731328.7397660943
 99231    | Subsequent hospital inpatient care, typically 15 minutes per day                                                                    |  56635 |   1715251.333556619
 99239    | Hospital discharge day management, more than 30 minutes                                                                             |  56046 |   4684961.880604446
 93010    | Routine electrocardiogram (ekg) using at least 12 leads with interpretation and report                                              |  55927 |   356173.8203728325
 99205    | New patient office or other outpatient visit, typically 60 minutes                                                                  |  55602 |   8010586.438355156
 97140    | Manual (physical) therapy techniques to 1 or more regions, each 15 minutes                                                          |  54251 |   939570.4051195918
 90732    | Vaccine for pneumococcal polysaccharide for injection beneath the skin or into muscle, patient 2 years or older                     |  52471 |  6019631.3152424221
 99283    | Emergency department visit, moderately severe problem                                                                               |  49543 |   2288928.984251447
 81003    | Automated urinalysis test                                                                                                           |  44561 |    98405.5360177546
 99441    | Physician telephone patient service, 5-10 minutes of medical discussion                                                             |  43117 |  1257097.2359553850
 99202    | New patient office or other outpatient visit, typically 20 minutes                                                                  |  42792 |  2070878.5854152711
 83036    | Hemoglobin a1c level                                                                                                                |  42782 |   407182.8026240224
 97112    | Therapeutic procedure to re-educate brain-to-nerve-to-muscle function, each 15 minutes                                              |  42372 |  1012849.8280947495
 20610    | Aspiration and/or injection of large joint or joint capsule                                                                         |  41389 |  1810328.0142457854
 73030    | X-ray of shoulder, minimum of 2 views                                                                                               |  38872 |   561842.4849436635
 99238    | Hospital discharge day management, 30 minutes or less                                                                               |  38811 |   2207771.945425496
 97530    | Therapeutic activities to improve function, with one-on-one contact between patient and provider, each 15 minutes                   |  38619 |  1090338.0842512453
 00731    | Anesthesia for procedure on esophagus, stomach, and/or upper small bowel using an endoscope                                         |  37958 |   3328405.686412450
 92014    | Eye and medical examination for diagnosis and treatment, established patient, 1 or more visits                                      |  37476 |  3018173.8390938837
 73502    | X-ray of hip with pelvis, 2-3 views                                                                                                 |  37107 |   644880.2236082459
 93306    | Ultrasound examination of heart including color-depicted blood flow rate, direction, and valve function                             |  36429 |  3359228.0518724806
 85025    | Complete blood cell count (red cells, white blood cell, platelets), automated test                                                  |  34818 |   264932.1778684835
 99308    | Subsequent nursing facility visit, typically 15 minutes per day                                                                     |  34505 |  1666039.2404811565
 90694    | Influenza virus vaccine, quadrivalent (aiiv4), inactivated, adjuvanted, preservative free, for injection into muscle, 0.5 ml dosage |  34250 |  1950506.6318325661
 99221    | Initial hospital inpatient care, typically 30 minutes per day                                                                       |  34106 |   2670213.807104740
 73630    | X-ray of foot, minimum of 3 views                                                                                                   |  34096 |   487816.7360513852
 99309    | Subsequent nursing facility visit, typically 25 minutes per day                                                                     |  33534 |  2145075.2105633972
(50 rows)

--- Costs by provider type --- 

 SELECT rndrng_prvdr_type, SUM(avg_mdcr_stdzd_amnt::numeric) AS sum 
  FROM medicare_services_2020 
  WHERE rndrng_prvdr_cntry = 'US' 
 GROUP BY rndrng_prvdr_type 
 ORDER BY sum DESC;
                    rndrng_prvdr_type                    |         sum         
---------------------------------------------------------+---------------------
 Internal Medicine                                       | 58917052.8831379593
 Diagnostic Radiology                                    | 51288149.7187553470
 Ambulatory Surgical Center                              | 49409297.2436648592
 Family Practice                                         | 42688932.9540866586
 Orthopedic Surgery                                      | 39988767.6137697686
 Cardiology                                              | 35472495.6539902859
 Nurse Practitioner                                      | 35058673.4707843248
 Ophthalmology                                           | 26477508.2409005982
 Physician Assistant                                     | 21783273.4810822323
 Dermatology                                             | 21234786.4458772746
 Anesthesiology                                          | 20541744.0553039005
 Emergency Medicine                                      | 19329989.6504710983
 General Surgery                                         | 18204793.8079349016
 Gastroenterology                                        | 17126013.5923642207
 Urology                                                 | 16529504.5804824697
 Vascular Surgery                                        | 13799702.8405793666
 Radiation Oncology                                      | 11941845.2868544810
 Neurology                                               | 11886485.2221781981
 Certified Registered Nurse Anesthetist (CRNA)           | 11861935.4233932923
 Hematology-Oncology                                     | 11594170.2456032777
 Nephrology                                              | 11587248.3508074838
 Interventional Cardiology                               | 10953284.0619002542
 Neurosurgery                                            | 10223120.3623227310
 Pulmonary Disease                                       |  9275118.9947531805
 Podiatry                                                |  9194198.0073358596
 Hospitalist                                             |  8946550.3872487954
 Ambulance Service Provider                              |  8643552.0312627581
 Physical Therapist in Private Practice                  |  8637480.6521712888
 Clinical Cardiac Electrophysiology                      |  8629187.2535226961
 Optometry                                               |  8596242.0912921156
 Mass Immunizer Roster Biller                            |  8085961.5405403647
 Otolaryngology                                          |  8000198.8416573533
 Physical Medicine and Rehabilitation                    |  6380097.9332212842
 Interventional Radiology                                |  6049665.9507577704
 Pathology                                               |  5320832.5946140383
 Psychiatry                                              |  5264487.5742880251
 Obstetrics & Gynecology                                 |  5080665.8755556535
 Thoracic Surgery                                        |  4506940.1667831761
 Medical Oncology                                        |  4190963.4060890860
 Clinical Laboratory                                     |  3849248.9899390865
 Pain Management                                         |  3821885.6565641764
 Independent Diagnostic Testing Facility (IDTF)          |  3671716.3967200499
 Interventional Pain Management                          |  3068538.5544815141
 Endocrinology                                           |  3048677.0028585732
 Cardiac Surgery                                         |  3017230.5159034399
 Rheumatology                                            |  2962775.6187918181
 Infectious Disease                                      |  2945429.4620880331
 Centralized Flu                                         |  2857618.7269215018
 Plastic and Reconstructive Surgery                      |  2738696.7886342651
 Psychologist, Clinical                                  |  2701955.3818984031
 Critical Care (Intensivists)                            |  2424893.6677184265
 Hand Surgery                                            |  2127572.7757158642
 Licensed Clinical Social Worker                         |  1863873.5784044568
 General Practice                                        |  1699631.4428015788
 Colorectal Surgery (Proctology)                         |  1400904.7233925261
 Geriatric Medicine                                      |  1250258.3266959279
 Sports Medicine                                         |  1162982.2878767958
 Chiropractic                                            |  1126168.7681957509
 Allergy/ Immunology                                     |  1035162.0354435257
 Surgical Oncology                                       |   968931.0035604395
 Gynecological Oncology                                  |   950071.7728579997
 Occupational Therapist in Private Practice              |   886458.4058701423
 Nuclear Medicine                                        |   807412.3295975807
 Hospice and Palliative Care                             |   662139.7138483721
 Advanced Heart Failure and Transplant Cardiology        |   641676.7344825588
 Oral Surgery (Dentist only)                             |   639650.5011994683
 Hematology                                              |   546128.9571397835
 Audiologist                                             |   503894.8346794693
 Sleep Medicine                                          |   465480.1178761008
 Pediatric Medicine                                      |   446202.7862256659
 Certified Clinical Nurse Specialist                     |   371696.2083755249
 Anesthesiology Assistant                                |    367902.225893643
 Pharmacy                                                |   335249.0306077812
 Osteopathic Manipulative Medicine                       |   322815.9300719926
 Undefined Physician type                                |   258766.6202388206
 Speech Language Pathologist                             |   234116.5407663195
 Opioid Treatment Program                                |   211641.5983895532
 Portable X-Ray Supplier                                 |   208259.0896154245
 Peripheral Vascular Disease                             |   205487.9988010750
 Maxillofacial Surgery                                   |   143803.6003294407
 Hematopoietic Cell Transplantation and Cellular Therapy |   140771.3779881785
 Radiation Therapy Center                                |   126146.3377541460
 Dentist                                                 |   121403.4931040404
 Registered Dietitian or Nutrition Professional          |    92694.9131373649
 Geriatric Psychiatry                                    |    78897.7069898560
 Preventive Medicine                                     |    72706.2204684061
 Neuropsychiatry                                         |    69752.9911765319
 Micrographic Dermatologic Surgery                       |    66004.3158514503
 Undersea and Hyperbaric Medicine                        |    55721.5854766522
 Addiction Medicine                                      |    53046.0000962938
 Clinic or Group Practice                                |    46386.0178581017
 Certified Nurse Midwife                                 |    41626.5833804583
 All Other Suppliers                                     |    37610.7069970153
 Public Health or Welfare Agency                         |    25910.6247126695
 Medical Toxicology                                      |    12744.9955007875
 Medical Genetics and Genomics                           |      6698.699065216
 Mammography Center                                      |      4241.129296314
 Medicare Diabetes Preventive Program                    |      2051.537341152
 Unknown Supplier/Provider Specialty                     |     1769.9205614333
 Slide Preparation Facility                              |       907.428904363
 Intensive Cardiac Rehabilitation                        |       683.299336710
 Adult Congenital Heart Disease                          |        5.4836842105
(102 rows)

--- Find most used service by distinct beneficiaries --- 
SELECT hcpcs_cd, COUNT(hcpcs_cd) * tot_bene_day_srvcs::numeric AS count, hcpcs_desc
FROM medicare_services_2020 
WHERE rndrng_prvdr_cntry = 'US"
GROUP BY hcpcs_cd, hcpcs_desc, tot_bene_day_srvcs
ORDER BY count DESC
LIMIT 50;

hcpcs_cd     count     hcpcs_desc 
 36415    | 1647349 | Insertion of needle into vein for collection of blood sample
 80053    | 1404354 | Blood test, comprehensive group of blood chemicals
 85025    | 1072166 | Complete blood cell count (red cells, white blood cell, platelets), automated test
 36415    | 1001756 | Insertion of needle into vein for collection of blood sample
 80061    |  985223 | Blood test, lipids (cholesterol and triglycerides)
 84460    |  929001 | Liver enzyme (sgpt), level
 36415    |  916514 | Insertion of needle into vein for collection of blood sample
 80053    |  820678 | Blood test, comprehensive group of blood chemicals
 80053    |  782146 | Blood test, comprehensive group of blood chemicals
 84443    |  725668 | Blood test, thyroid stimulating hormone (tsh)
 36415    |  649031 | Insertion of needle into vein for collection of blood sample
 85025    |  641705 | Complete blood cell count (red cells, white blood cell, platelets), automated test
 36415    |  614151 | Insertion of needle into vein for collection of blood sample
 80061    |  604686 | Blood test, lipids (cholesterol and triglycerides)
 80053    |  604044 | Blood test, comprehensive group of blood chemicals
 83036    |  601696 | Hemoglobin a1c level
 80053    |  586166 | Blood test, comprehensive group of blood chemicals
 80061    |  583779 | Blood test, lipids (cholesterol and triglycerides)
 36415    |  573562 | Insertion of needle into vein for collection of blood sample
 36415    |  573369 | Insertion of needle into vein for collection of blood sample
 85025    |  564236 | Complete blood cell count (red cells, white blood cell, platelets), automated test
 80053    |  557240 | Blood test, comprehensive group of blood chemicals
 80053    |  551659 | Blood test, comprehensive group of blood chemicals
 36415    |  528470 | Insertion of needle into vein for collection of blood sample
 36415    |  520261 | Insertion of needle into vein for collection of blood sample
 85025    |  485710 | Complete blood cell count (red cells, white blood cell, platelets), automated test
 G0471    |  478496 | Collection of venous blood by venipuncture or urine sample by catheterization from an individual in a skilled nursing facility (snf) or by a laboratory on behalf of a home health agency (hha)
 36415    |  476603 | Insertion of needle into vein for collection of blood sample
 36415    |  469785 | Insertion of needle into vein for collection of blood sample
 85025    |  465730 | Complete blood cell count (red cells, white blood cell, platelets), automated test
 G0249    |  461016 | Provision of test materials and equipment for home inr monitoring of patient with either mechanical heart valve(s), chronic atrial fibrillation, or venous thromboembolism who meets medicare coverage criteria; includes: provision of materials for use in the
 G0008    |  460430 | Administration of influenza virus vaccine
 84443    |  456848 | Blood test, thyroid stimulating hormone (tsh)
 80053    |  455349 | Blood test, comprehensive group of blood chemicals
 84443    |  451894 | Blood test, thyroid stimulating hormone (tsh)
 80053    |  445099 | Blood test, comprehensive group of blood chemicals
 36415    |  443527 | Insertion of needle into vein for collection of blood sample
 85025    |  442319 | Complete blood cell count (red cells, white blood cell, platelets), automated test
 G0249    |  434497 | Provision of test materials and equipment for home inr monitoring of patient with either mechanical heart valve(s), chronic atrial fibrillation, or venous thromboembolism who meets medicare coverage criteria; includes: provision of materials for use in the
 80053    |  431423 | Blood test, comprehensive group of blood chemicals
 85025    |  430305 | Complete blood cell count (red cells, white blood cell, platelets), automated test
 80053    |  428714 | Blood test, comprehensive group of blood chemicals
 85025    |  425282 | Complete blood cell count (red cells, white blood cell, platelets), automated test
 36415    |  423198 | Insertion of needle into vein for collection of blood sample
 81528    |  412534 | Gene analysis (colorectal cancer)
 80053    |  410042 | Blood test, comprehensive group of blood chemicals
 83036    |  406668 | Hemoglobin a1c level
 80061    |  402387 | Blood test, lipids (cholesterol and triglycerides)
 80061    |  394086 | Blood test, lipids (cholesterol and triglycerides)
 85025    |  391453 | Complete blood cell count (red cells, white blood cell, platelets), automated test
(50 rows)

--- most utilized services --- 

SELECT hcpcs_cd, SUM(tot_srvcs::numeric) AS count, hcpcs_desc
dialysisdb-# FROM medicare_services_2020 
dialysisdb-# WHERE rndrng_prvdr_cntry = 'US'
dialysisdb-# GROUP BY hcpcs_cd, hcpcs_desc 
dialysisdb-# ORDER BY count DESC
dialysisdb-# LIMIT 50;
 hcpcs_cd |    count    |                                                                                      hcpcs_desc                                                                                       
----------+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 A0425    | 121513492.7 | Ground mileage, per statute mile
 Q9967    |  89883236.8 | Low osmolar contrast material, 300-399 mg/ml iodine concentration, per ml
 99214    |  87623941.6 | Established patient office or other outpatient, visit typically 25 minutes
 99213    |  74816265.8 | Established patient office or other outpatient visit, typically 15 minutes
 P9603    |  57800815.4 | Travel allowance one way in connection with medically necessary laboratory specimen collection drawn from home bound or nursing home bound patient; prorated miles actually travelled
 J1439    |    53613506 | Injection, ferric carboxymaltose, 1 mg
 97110    |  47794984.4 | Therapeutic exercise to develop strength, endurance, range of motion, and flexibility, each 15 minutes
 Q0138    |    47654561 | Injection, ferumoxytol, for treatment of iron deficiency anemia, 1 mg (non-esrd use)
 J0897    |    45291470 | Injection, denosumab, 1 mg
 J0717    |    41410519 | Injection, certolizumab pegol, 1 mg (code may be used for medicare when drug administered under the direct supervision of a physician, not for use when drug is self administered)
 36415    |    41116951 | Insertion of needle into vein for collection of blood sample
 99232    |  38914743.0 | Subsequent hospital inpatient care, typically 25 minutes per day
 J0878    |    36789856 | Injection, daptomycin, 1 mg
 J1071    |  36212292.9 | Injection, testosterone cypionate, 1 mg
 J0585    |  33780592.4 | Injection, onabotulinumtoxina, 1 unit
 A9575    |  28895544.9 | Injection, gadoterate meglumine, 0.1 ml
 80053    |    26113398 | Blood test, comprehensive group of blood chemicals
 85025    |  26076160.9 | Complete blood cell count (red cells, white blood cell, platelets), automated test
 J0881    |  25492069.8 | Injection, darbepoetin alfa, 1 microgram (non-esrd use)
 99233    |  23968711.0 | Subsequent hospital inpatient care, typically 35 minutes per day
 Q5101    |    23928005 | Injection, filgrastim-sndz, biosimilar, (zarxio), 1 microgram
 J7192    |  22806986.2 | Factor viii (antihemophilic factor, recombinant) per i.u., not otherwise specified
 97140    |  22262719.8 | Manual (physical) therapy techniques to 1 or more regions, each 15 minutes
 J3262    |    21567393 | Injection, tocilizumab, 1 mg
 J9271    |  19161478.6 | Injection, pembrolizumab, 1 mg
 80061    |    16982931 | Blood test, lipids (cholesterol and triglycerides)
 88305    |  16814454.3 | Pathology examination of tissue using a microscope, intermediate complexity
 J1453    |    16592916 | Injection, fosaprepitant, 1 mg
 97530    |  16295716.1 | Therapeutic activities to improve function, with one-on-one contact between patient and provider, each 15 minutes
 17003    |    16167800 | Destruction of 2-14 skin growths
 A9585    |  16056192.5 | Injection, gadobutrol, 0.1 ml
 93010    |  15765551.3 | Routine electrocardiogram (ekg) using at least 12 leads with interpretation and report
 J1100    |  15696086.5 | Injection, dexamethasone sodium phosphate, 1 mg
 71045    |  15474827.2 | X-ray of chest, 1 view
 97112    |  15425224.4 | Therapeutic procedure to re-educate brain-to-nerve-to-muscle function, each 15 minutes
 G0008    |    15322487 | Administration of influenza virus vaccine
 84443    |  13381028.8 | Blood test, thyroid stimulating hormone (tsh)
 83036    |    13116837 | Hemoglobin a1c level
 J7328    |  12905587.2 | Hyaluronan or derivative, gelsyn-3, for intra-articular injection, 0.1 mg
 J1602    |  11424332.2 | Injection, golimumab, 1 mg, for intravenous use
 J3301    |  11421467.8 | Injection, triamcinolone acetonide, not otherwise specified, 10 mg
 98941    |    11193445 | Chiropractic manipulative treatment, 3 to 4 spinal regions
 J0129    |    11127563 | Injection, abatacept, 10 mg (code may be used for medicare when drug administered under the direct supervision of a physician, not for use when drug is self administered)
 99308    |  10516142.9 | Subsequent nursing facility visit, typically 15 minutes per day
 92014    |    10309822 | Eye and medical examination for diagnosis and treatment, established patient, 1 or more visits
 J9267    |    10201264 | Injection, paclitaxel, 1 mg
 99309    |   9727551.0 | Subsequent nursing facility visit, typically 25 minutes per day
 J9263    |     9309900 | Injection, oxaliplatin, 0.5 mg
 99285    |     9186204 | Emergency department visit, problem with significant threat to life or function
 99223    |   9060195.8 | Initial hospital inpatient care, typically 70 minutes per day
(50 rows)

--- Provider utilization rates --- 
--- see provider billing rates to compare ---- 

SELECT 
 rndrng_NPI, rndrng_prvdr_last_org_name, rndrng_prvdr_first_name, rndrng_prvdr_MI, rndrng_prvdr_type, SUM(tot_srvcs::numeric) AS total_services
FROM medicare_services_2020 
  GROUP BY rndrng_NPI, rndrng_prvdr_last_org_name, rndrng_prvdr_first_name, rndrng_prvdr_MI, rndrng_prvdr_type
  ORDER BY total_services DESC 
LIMIT 50;


 rndrng_npi |         rndrng_prvdr_last_org_name          | rndrng_prvdr_first_name | rndrng_prvdr_mi |    rndrng_prvdr_type    | total_services 
------------+---------------------------------------------+-------------------------+-----------------+-------------------------+----------------
 1417915653 | Accredo Health Group Inc                    |                         |                 | Pharmacy                |       18551216
 1538144910 | Laboratory Corporation Of America Holdings  |                         |                 | Clinical Laboratory     |       15587891
 1013998921 | Caremark, L.L.C.                            |                         |                 | Pharmacy                |       10590601
 1063497451 | Laboratory Corporation Of America Holdings  |                         |                 | Clinical Laboratory     |        9109659
 1891731626 | Quest Diagnostics Clinical Laboratories Inc |                         |                 | Clinical Laboratory     |        8296484
 1174906432 | Phlebxpress                                 |                         |                 | Clinical Laboratory     |      8225120.4
 1366479099 | Unilab Corporation                          |                         |                 | Clinical Laboratory     |        6715914
 1932145778 | Quest Diagnostics Incorporated              |                         |                 | Clinical Laboratory     |        5958559
 1932184322 | Laboratory Corporation Of America Holdings  |                         |                 | Clinical Laboratory     |        5208971
 1295726032 | Laboratory Corporation Of America Holdings  |                         |                 | Clinical Laboratory     |        5194709
 1538105366 | Sonora Quest Laboratories, Llc.             |                         |                 | Clinical Laboratory     |        4644908
 1659352276 | Laboratory Corporation Of America           |                         |                 | Clinical Laboratory     |        4457790
 1790101681 | Amerathon,llc                               |                         |                 | Clinical Laboratory     |        4111268
 1194769497 | Clinical Pathology Laboratories, Inc.       |                         |                 | Clinical Laboratory     |        4073799
 1932166386 | Quest Diagnostics Clinical Laboratories Inc |                         |                 | Clinical Laboratory     |        3997743
 1790721538 | Quest Diagnostics Clinical Laboratories Inc |                         |                 | Clinical Laboratory     |        3884799
 1043382302 | Procare Pharmacy Direct, Llc.               |                         |                 | Pharmacy                |      3884170.2
 1619913449 | Unilab Corporation                          |                         |                 | Clinical Laboratory     |        3854237
 1134277494 | Bio-Reference Laboratories, Inc.            |                         |                 | Clinical Laboratory     |        3679890
 1255314704 | Laboratory Corporation Of America           |                         |                 | Clinical Laboratory     |        3461604
 1881630614 | Quest Diagnostics Llc Il                    |                         |                 | Clinical Laboratory     |        3182342
 1609812445 | Labone Llc                                  |                         |                 | Clinical Laboratory     |        3095013
 1518903350 | Quest Diagnostics Clinical Laboratories Inc |                         |                 | Clinical Laboratory     |        2939730
 1295823540 | American Health Associates Inc              |                         |                 | Clinical Laboratory     |        2920650
 1740262880 | Laboratory Corporation Of America           |                         |                 | Clinical Laboratory     |        2898889
 1265418669 | Laboratory Corporation Of America           |                         |                 | Clinical Laboratory     |        2847935
 1780001859 | Vista Clinical Diagnostics Llc              |                         |                 | Clinical Laboratory     |        2843262
 1760579825 | Clinical Laboratory Services, Inc.          |                         |                 | Clinical Laboratory     |        2742141
 1205872041 | Quest Diagnostics Clinical Laboratories Inc |                         |                 | Clinical Laboratory     |        2733593
 1326104613 | Quest Diagnostics Clinical Laboratories Inc |                         |                 | Clinical Laboratory     |        2729043
 1720378524 | Star Lab, Inc                               |                         |                 | Clinical Laboratory     |        2642077
 1255696175 | Veni-Express, Inc.                          |                         |                 | Clinical Laboratory     |        2641994
 1740361690 | Gamma Healthcare Inc                        |                         |                 | Clinical Laboratory     |        2584931
 1598731770 | Anastasio                                   | Patrick                 | J               | Internal Medicine       |        2491370
 1245307818 | Quest Diagnostics Incorporated Md           |                         |                 | Clinical Laboratory     |        2411765
 1841539541 | Kade                                        | Hemant                  |                 | Infectious Disease      |        2366765
 1881679751 | Laboratory Corporation Of America           |                         |                 | Clinical Laboratory     |        2342387
 1407113020 | Laboratory Of Florida Llc                   |                         |                 | Clinical Laboratory     |        2209915
 1194062448 | Quest Diagnostics Massachusetts Llc         |                         |                 | Clinical Laboratory     |        2165956
 1376587113 | Sunrise Medical Laboratories, Inc.          |                         |                 | Clinical Laboratory     |        2158895
 1952347791 | Quest Diagnostics Llc                       |                         |                 | Clinical Laboratory     |        2101322
 1073599478 | Laboratory Corporation Of America           |                         |                 | Clinical Laboratory     |        2100414
 1114315793 | Gamma Healthcare, Inc                       |                         |                 | Clinical Laboratory     |        2005611
 1851636435 | Unique Lab Services, Llc                    |                         |                 | Clinical Laboratory     |        1969794
 1497803209 | Okwuasaba                                   | Peter                   | A               | Infectious Disease      |        1822540
 1366543795 | Northwell Health Laboratories               |                         |                 | Clinical Laboratory     |        1816038
 1235186800 | Pathgroup Labs, Llc                         |                         |                 | Clinical Laboratory     |        1791596
 1336131481 | Sastry                                      | Vatsala                 | S               | Infectious Disease      |        1749650
 1700865094 | Symphony Diagnostic Services No 1 Llc       |                         |                 | Portable X-Ray Supplier |        1699454
 1548282510 | Accredo Health Group Inc                    |                         |                 | Pharmacy                |        1652232
(50 rows)

--- Average medicare reimbursement by provider speciality --- 
SELECT rndrng_prvdr_type, AVG(Avg_mdcr_Pymnt_Amnt::numeric) as Avg_Medicare_Payment
FROM medicare_services_2020
GROUP BY rndrng_prvdr_type
ORDER BY avg_medicare_payment DESC;

 rndrng_prvdr_type                    | avg_medicare_payment 
---------------------------------------------------------+----------------------
 Ambulatory Surgical Center                              | 914.5012665168539083
 Dentist                                                 | 417.3842831230057402
 Cardiac Surgery                                         | 339.8992199448760626
 Thoracic Surgery                                        | 297.2374500763793903
 Radiation Therapy Center                                | 279.8081119563046563
 Ambulance Service Provider                              | 273.9233673123778668
 Oral Surgery (Dentist only)                             | 257.7722058370409783
 Neurosurgery                                            | 251.3815274035095516
 Vascular Surgery                                        | 233.7701752973854214
 Micrographic Dermatologic Surgery                       | 223.1630997697973064
 Peripheral Vascular Disease                             | 198.7447999628433553
 Clinic or Group Practice                                | 197.5699805361046610
 All Other Suppliers                                     | 179.3487593080610577
 Surgical Oncology                                       | 162.8905178714428893
 Radiation Oncology                                      | 154.2654257970779934
 Orthopedic Surgery                                      | 151.6947318317804291
 Plastic and Reconstructive Surgery                      | 149.9457579289270063
 General Surgery                                         | 139.9032752814743573
 Opioid Treatment Program                                | 134.6952433639364890
 Clinical Cardiac Electrophysiology                      | 130.7317712031850085
 Undefined Physician type                                | 130.4431069457652522
 Gynecological Oncology                                  | 127.7895140723152282
 Interventional Radiology                                | 125.9576652158535119
 Independent Diagnostic Testing Facility (IDTF)          | 123.9098096219917132
 Ophthalmology                                           | 123.4556671982519828
 Colorectal Surgery (Proctology)                         | 121.6496274711894408
 Interventional Cardiology                               | 119.7200411457270439
 Medical Toxicology                                      | 110.6405745146865546
 Certified Registered Nurse Anesthetist (CRNA)           | 110.4219894653971499
 Nuclear Medicine                                        | 108.2737906735434111
 Nephrology                                              | 107.4805524344678285
 Dermatology                                             | 107.0644862290393111
 Maxillofacial Surgery                                   | 105.9702490993313050
 Gastroenterology                                        | 103.3065177329782041
 Anesthesiology                                          | 102.8288996135161688
 Hematopoietic Cell Transplantation and Cellular Therapy |  99.3492494015428470
 Urology                                                 |  98.5947879849977432
 Interventional Pain Management                          |  98.4668176308004786
 Otolaryngology                                          |  98.4172893736699894
 Hand Surgery                                            |  95.6712117110573891
 Sleep Medicine                                          |  95.4996395260221034
 Critical Care (Intensivists)                            |  94.0961568752589869
 Neurology                                               |  93.9752762059793914
 Hospitalist                                             |  93.4402516780898207
 Pain Management                                         |  93.0981296424475128
 Medical Genetics and Genomics                           |  92.5684629326027397
 Neuropsychiatry                                         |  92.5088039974187003
 Emergency Medicine                                      |  91.1806726832094149
 Cardiology                                              |  90.7072969957766447
 Anesthesiology Assistant                                |  90.6395586127540508
 Hospice and Palliative Care                             |  89.0721145796156164
 Mammography Center                                      |  85.4645477159600000
 Intensive Cardiac Rehabilitation                        |  84.1225855192500000
 Sports Medicine                                         |  82.9048624140444570
 Infectious Disease                                      |  81.5823259753580056
 Physical Medicine and Rehabilitation                    |  80.6647082503447833
 Geriatric Psychiatry                                    |  77.7416250599328200
 Hematology                                              |  76.5750421051359326
 Medical Oncology                                        |  75.8913108613583179
 Psychologist, Clinical                                  |  75.2821436166259776
 Advanced Heart Failure and Transplant Cardiology        |  74.9630461015241722
 Osteopathic Manipulative Medicine                       |  74.2001559841994344
 Pulmonary Disease                                       |  73.3012776477962194
 Speech Language Pathologist                             |  72.8369222756742337
 Hematology-Oncology                                     |  72.3621139347482048
 Geriatric Medicine                                      |  71.6031542093697454
 Psychiatry                                              |  70.2904522952103665
 Addiction Medicine                                      |  64.8054828187705302
 Undersea and Hyperbaric Medicine                        |  63.9737542754355972
 Internal Medicine                                       |  63.7825395913640874
 Obstetrics & Gynecology                                 |  63.7763316959516759
 Pharmacy                                                |  60.8467802521141384
 Medicare Diabetes Preventive Program                    |  60.7655475656764706
 Mass Immunizer Roster Biller                            |  59.6722177495279465
 Licensed Clinical Social Worker                         |  58.9101594552605537
 Preventive Medicine                                     |  58.4601419153864865
 General Practice                                        |  57.7341430066583156
 Centralized Flu                                         |  56.5486768237496779
 Pediatric Medicine                                      |  55.6863872088550283
 Podiatry                                                |  54.3582106039140416
 Optometry                                               |  53.7943763976221746
 Certified Clinical Nurse Specialist                     |  53.5001921317872424
 Endocrinology                                           |  53.3653917077378324
 Physician Assistant                                     |  51.7520432304219917
 Family Practice                                         |  49.5024316348366520
 Diagnostic Radiology                                    |  48.6384237523277748
 Nurse Practitioner                                      |  48.3199149165149277
 Unknown Supplier/Provider Specialty                     |  43.7052306402170732
 Certified Nurse Midwife                                 |  43.4180985193746146
 Rheumatology                                            |  43.3577140602161897
 Public Health or Welfare Agency                         |  42.9240942271048154
 Slide Preparation Facility                              |  41.8462258560000000
 Allergy/ Immunology                                     |  40.2753913831262363
 Pathology                                               |  37.7951747395459053
 Clinical Laboratory                                     |  34.9232595820086606
 Occupational Therapist in Private Practice              |  31.6923212525371532
 Registered Dietitian or Nutrition Professional          |  31.4296630920619973
 Physical Therapist in Private Practice                  |  29.5705573993534466
 Chiropractic                                            |  26.0945766856176033
 Audiologist                                             |  26.0004533205022010
 Portable X-Ray Supplier                                 |  24.8769285042828064
 Adult Congenital Heart Disease                          |   5.2768421053000000
(102 rows)

--- Most utilized AND most expensive servces --- 
SELECT 
 hcpcs_cd, hcpcs_desc, SUM(avg_mdcr_pymnt_amnt::numeric) AS total_payment 
FROM medicare_services_2020 
  GROUP BY hcpcs_cd, hcpcs_desc
  ORDER BY SUM(tot_srvcs::numeric) DESC, SUM(avg_mdcr_pymnt_amnt::numeric) DESC
LIMIT 25;


 hcpcs_cd |                                                                                      hcpcs_desc                                                                                       |    total_payment    
----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------
 A0425    | Ground mileage, per statute mile                                                                                                                                                      |    62413.6640218479
 Q9967    | Low osmolar contrast material, 300-399 mg/ml iodine concentration, per ml                                                                                                             |      970.8189409755
 99214    | Established patient office or other outpatient, visit typically 25 minutes                                                                                                            | 30501122.3376745705
 99213    | Established patient office or other outpatient visit, typically 15 minutes                                                                                                            | 21316675.8621678916
 P9603    | Travel allowance one way in connection with medically necessary laboratory specimen collection drawn from home bound or nursing home bound patient; prorated miles actually travelled |      276.2090327303
 J1439    | Injection, ferric carboxymaltose, 1 mg                                                                                                                                                |     1173.0525893532
 97110    | Therapeutic exercise to develop strength, endurance, range of motion, and flexibility, each 15 minutes                                                                                |  1288934.5690899754
 Q0138    | Injection, ferumoxytol, for treatment of iron deficiency anemia, 1 mg (non-esrd use)                                                                                                  |     1069.5267150529
 J0897    | Injection, denosumab, 1 mg                                                                                                                                                            |   146866.0052422117
 J0717    | Injection, certolizumab pegol, 1 mg (code may be used for medicare when drug administered under the direct supervision of a physician, not for use when drug is self administered)    |     4264.5079856408
 36415    | Insertion of needle into vein for collection of blood sample                                                                                                                          |   269479.5666739459
 99232    | Subsequent hospital inpatient care, typically 25 minutes per day                                                                                                                      |  9929607.5880819016
 J0878    | Injection, daptomycin, 1 mg                                                                                                                                                           |       31.0215848797
 J1071    | Injection, testosterone cypionate, 1 mg                                                                                                                                               |       21.2207636661
 J0585    | Injection, onabotulinumtoxina, 1 unit                                                                                                                                                 |    14618.5519984568
 A9575    | Injection, gadoterate meglumine, 0.1 ml                                                                                                                                               |      335.2696958660
 80053    | Blood test, comprehensive group of blood chemicals                                                                                                                                    |   277021.2546264511
 85025    | Complete blood cell count (red cells, white blood cell, platelets), automated test                                                                                                    |   267084.2995593376
 J0881    | Injection, darbepoetin alfa, 1 microgram (non-esrd use)                                                                                                                               |     3568.8709010519
 99233    | Subsequent hospital inpatient care, typically 35 minutes per day                                                                                                                      | 10801279.7014952091
 Q5101    | Injection, filgrastim-sndz, biosimilar, (zarxio), 1 microgram                                                                                                                         |      243.4850680988
 J7192    | Factor viii (antihemophilic factor, recombinant) per i.u., not otherwise specified                                                                                                    |    14778.4645981603
 97140    | Manual (physical) therapy techniques to 1 or more regions, each 15 minutes                                                                                                            |   957359.3332906017
 J3262    | Injection, tocilizumab, 1 mg                                                                                                                                                          |     1721.4777710149
 J9271    | Injection, pembrolizumab, 1 mg                                                                                                                                                        |    57469.0516050561
(25 rows)

--- Top service and provider speciality by state --- 
SELECT DISTINCT ON (rndrng_prvdr_state_abrvtn)
  rndrng_prvdr_state_abrvtn,
  rndrng_prvdr_type,
  HCPCS_desc,
  Tot_srvcs
FROM medicare_services_2020
WHERE HCPCS_Drug_ind = 'N'
ORDER BY rndrng_prvdr_state_abrvtn, Tot_srvcs DESC;

 rndrng_prvdr_state_abrvtn |           rndrng_prvdr_type            |                                                    hcpcs_desc                                                     | tot_srvcs 
---------------------------+----------------------------------------+-------------------------------------------------------------------------------------------------------------------+-----------
 AA                        | Emergency Medicine                     | Emergency department visit, problem of high severity                                                              | 93
 AE                        | Internal Medicine                      | Physician telephone patient service, 5-10 minutes of medical discussion                                           | 97
 AK                        | Physical Therapist in Private Practice | Therapeutic exercise to develop strength, endurance, range of motion, and flexibility, each 15 minutes            | 996
 AL                        | Pathology                              | Pathology examination of tissue using a microscope, intermediate complexity                                       | 999
 AP                        | Physician Assistant                    | Established patient office or other outpatient visit, typically 15 minutes                                        | 99
 AR                        | Urology                                | Established patient office or other outpatient visit, typically 15 minutes                                        | 999
 AS                        | Nurse Practitioner                     | Emergency department visit, problem of high severity                                                              | 81
 AZ                        | Physician Assistant                    | Destruction of 2-14 skin growths                                                                                  | 999
 CA                        | Internal Medicine                      | Subsequent nursing facility visit, typically 15 minutes per day                                                   | 999
 CO                        | Physical Therapist in Private Practice | Therapeutic exercise to develop strength, endurance, range of motion, and flexibility, each 15 minutes            | 999
 CT                        | Pathology                              | Pathology examination of tissue using a microscope, intermediate complexity                                       | 999
 DC                        | Ophthalmology                          | Eye and medical examination for diagnosis and treatment, established patient                                      | 996
 DE                        | Physical Therapist in Private Practice | Therapeutic activities to improve function, with one-on-one contact between patient and provider, each 15 minutes | 999
 FL                        | Clinical Laboratory                    | Thyroid hormone, t3 measurement                                                                                   | 9998
 GA                        | Pain Management                        | Testing for presence of drug                                                                                      | 999
 GU                        | Internal Medicine                      | Administration of influenza virus vaccine                                                                         | 99
 HI                        | Cardiology                             | Established patient office or other outpatient, visit typically 25 minutes                                        | 999
 IA                        | Ambulance Service Provider             | Ground mileage, per statute mile                                                                                  | 9994.9
 ID                        | Physician Assistant                    | Insertion of needle into vein for collection of blood sample                                                      | 999
 IL                        | Psychiatry                             | Psychotherapy, 30 minutes                                                                                         | 999
 IN                        | Podiatry                               | Removal of tissue from 6 or more finger or toe nails                                                              | 999
 KS                        | Cardiology                             | Blood test, clotting time                                                                                         | 999
 KY                        | Nephrology                             | Subsequent hospital inpatient care, typically 35 minutes per day                                                  | 999
 LA                        | Clinical Laboratory                    | Liver enzyme (sgpt), level                                                                                        | 999
 MA                        | Allergy/ Immunology                    | Injection of allergenic extracts into skin for immediate reaction analysis                                        | 999
 MD                        | Anesthesiology                         | Anesthesia for lens surgery                                                                                       | 999
 ME                        | Podiatry                               | Removal of 2 to 4 thickened skin growths                                                                          | 999
 MI                        | Radiation Oncology                     | Ultrasonic guidance for placement of radiation therapy fields                                                     | 999
 MN                        | Medical Oncology                       | Established patient office or other outpatient, visit typically 25 minutes                                        | 999
 MO                        | Physical Therapist in Private Practice | Therapeutic exercise to develop strength, endurance, range of motion, and flexibility, each 15 minutes            | 999
 MP                        | Optometry                              | Photography of the retina                                                                                         | 98
 MS                        | Ambulance Service Provider             | Ambulance service, basic life support, non-emergency transport, (bls)                                             | 999
 MT                        | Physical Therapist in Private Practice | Therapeutic procedure to re-educate brain-to-nerve-to-muscle function, each 15 minutes                            | 994
 NC                        | Physical Therapist in Private Practice | Water pool therapy with therapeutic exercises to 1 or more areas, each 15 minutes                                 | 999
 ND                        | Internal Medicine                      | Blood test, basic group of blood chemicals                                                                        | 999
 NE                        | Physical Therapist in Private Practice | Water pool therapy with therapeutic exercises to 1 or more areas, each 15 minutes                                 | 997
 NH                        | Internal Medicine                      | Established patient office or other outpatient, visit typically 25 minutes                                        | 999
 NJ                        | Allergy/ Immunology                    | Injection of allergenic extracts into skin, accessed through the skin                                             | 9998
 NM                        | Ambulance Service Provider             | Ambulance service, advanced life support, emergency transport, level 1 (als 1 - emergency)                        | 998
 NV                        | Physical Therapist in Private Practice | Therapeutic activities to improve function, with one-on-one contact between patient and provider, each 15 minutes | 999
 NY                        | Cardiology                             | Subsequent hospital inpatient care, typically 25 minutes per day                                                  | 999
 OH                        | Clinical Laboratory                    | Sex hormone binding globulin (protein) level                                                                      | 999
 OK                        | Physical Therapist in Private Practice | Therapeutic activities to improve function, with one-on-one contact between patient and provider, each 15 minutes | 999
 OR                        | Ophthalmology                          | Diagnostic imaging of retina                                                                                      | 999
 PA                        | Physical Therapist in Private Practice | Therapeutic exercise to develop strength, endurance, range of motion, and flexibility, each 15 minutes            | 999
 PR                        | Cardiology                             | Established patient office or other outpatient visit, typically 15 minutes                                        | 999
 PW                        | Nurse Practitioner                     | Subsequent hospital inpatient care, typically 25 minutes per day                                                  | 52
 RI                        | Diagnostic Radiology                   | Screening digital tomography of both breasts                                                                      | 999
 SC                        | Internal Medicine                      | Established patient office or other outpatient, visit typically 25 minutes                                        | 999
 SD                        | Podiatry                               | Established patient office or other outpatient visit, typically 10 minutes                                        | 998
 TN                        | Ophthalmology                          | Eye and medical examination for diagnosis and treatment, established patient, 1 or more visits                    | 999
 TX                        | Radiation Oncology                     | Ct scan guidance for insertion of radiation therapy fields                                                        | 999
 UT                        | Physical Therapist in Private Practice | Manual (physical) therapy techniques to 1 or more regions, each 15 minutes                                        | 999
 VA                        | Ambulance Service Provider             | Ground mileage, per statute mile                                                                                  | 999.3
 VI                        | Physical Therapist in Private Practice | Therapeutic exercise to develop strength, endurance, range of motion, and flexibility, each 15 minutes            | 995
 VT                        | Physical Therapist in Private Practice | Manual (physical) therapy techniques to 1 or more regions, each 15 minutes                                        | 999
 WA                        | Dermatology                            | Destruction of 2-14 skin growths                                                                                  | 999
 WI                        | Ophthalmology                          | Diagnostic imaging of retina                                                                                      | 998
 WV                        | Diagnostic Radiology                   | X-ray of chest, 1 view                                                                                            | 999
 WY                        | Physical Medicine and Rehabilitation   | Subsequent hospital inpatient care, typically 35 minutes per day                                                  | 995
 XX                        | Internal Medicine                      | Established patient office or other outpatient visit, typically 15 minutes                                        | 992
 ZZ                        | Gastroenterology                       | Biopsy of the esophagus, stomach, and/or upper small bowel using an endoscope                                     | 99
(62 rows)


Questions to ask: which of these services are prevenative/preventable? what are the lifestyle risks associated with each? do geographic factors have an impact?
how much money could you save? what story does the data tell? --- ambulatory mileage reimbursement is high... either travled far or alot?... --- 


---- how many services were performed for psychology --- 

SELECT 
 hcpcs_cd, hcpcs_desc, SUM(tot_srvcs::numeric) AS total_services
FROM medicare_services_2020 
  WHERE rndrng_prvdr_type = 'Psychologist, Clinical'
  GROUP BY hcpcs_cd, hcpcs_desc
  ORDER BY total_services DESC 
LIMIT 50;
 hcpcs_cd |                                                                                                                            hcpcs_desc                                                                                                                            | total_services 
----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------
 90837    | Psychotherapy, 60 minutes                                                                                                                                                                                                                                        |      1574448.7
 90834    | Psychotherapy, 45 minutes                                                                                                                                                                                                                                        |      1398185.6
 90832    | Psychotherapy, 30 minutes                                                                                                                                                                                                                                        |       942205.5
 90791    | Psychiatric diagnostic evaluation                                                                                                                                                                                                                                |       336690.5
 96139    | Psychological or neuropsychological test administration and scoring by technician, additional 30 minutes                                                                                                                                                         |       264449.5
 96133    | Neuropsychological testing evaluation by qualified health care professional, additional 60 minutes                                                                                                                                                               |       257639.5
 96137    | Psychological or neuropsychological test administration and scoring by qualified health care professional, additional 30 minutes                                                                                                                                 |       251335.7
 90785    | Interactive complexity                                                                                                                                                                                                                                           |         127091
 96132    | Neuropsychological testing evaluation by qualified health care professional, first 60 minutes                                                                                                                                                                    |       126979.5
 96136    | Psychological or neuropsychological test administration and scoring by qualified health care professional, first 30 minutes                                                                                                                                      |          87536
 96116    | Neurobehavioral status examination by qualified health care professional with interpretation and report, first 60 minutes                                                                                                                                        |          77467
 90853    | Group psychotherapy                                                                                                                                                                                                                                              |          62006
 96138    | Psychological or neuropsychological test administration and scoring by technician, first 30 minutes                                                                                                                                                              |          51597
 96131    | Psychological testing evaluation by qualified health care professional, additional 60 minutes                                                                                                                                                                    |        50805.0
 96130    | Psychological testing evaluation by qualified health care professional, first 60 minutes                                                                                                                                                                         |          47633
 96121    | Neurobehavioral status examination by qualified health care professional with interpretation and report, additional 60 minutes                                                                                                                                   |          28963
 96158    | Health behavior intervention, individual, face-to-face; initial 30 minutes                                                                                                                                                                                       |          23895
 Q3014    | Telehealth originating site facility fee                                                                                                                                                                                                                         |          22428
 96159    | Health behavior intervention, individual, face-to-face; each additional 15 minutes                                                                                                                                                                               |          21299
 96165    | Health behavior intervention, group, face-to-face; each additional 15 minutes                                                                                                                                                                                    |          18152
 96156    | Health behavior assessment, or re-assessment                                                                                                                                                                                                                     |          14643
 90847    | Family psychotherapy including patient, 50 minutes                                                                                                                                                                                                               |           9077
 97130    | Therapeutic interventions that focus on cognitive function (eg, attention, memory, reasoning, executive function, problem solving, and/or pragmatic functioning) and compensatory strategies to manage the performance of an activity (eg, managing time or sche |           8550
 98968    | Telephone assessment and management service, 21-30 minutes of medical discussion                                                                                                                                                                                 |           7773
 96164    | Health behavior intervention, group, face-to-face; initial 30 minutes                                                                                                                                                                                            |           7437
 99484    | Care management services for behavioral health conditions, at least 20 minutes clinical staff time                                                                                                                                                               |           5018
 97129    | Therapeutic interventions that focus on cognitive function (eg, attention, memory, reasoning, executive function, problem solving, and/or pragmatic functioning) and compensatory strategies to manage the performance of an activity (eg, managing time or sche |           3509
 90839    | Psychotherapy for crisis, first 60 minutes                                                                                                                                                                                                                       |           2342
 90846    | Family psychotherapy, 50 minutes                                                                                                                                                                                                                                 |           1895
 99443    | Physician telephone patient service, 21-30 minutes of medical discussion                                                                                                                                                                                         |           1870
 99233    | Subsequent hospital inpatient care, typically 35 minutes per day                                                                                                                                                                                                 |           1562
 90880    | Hypnotherapy                                                                                                                                                                                                                                                     |           1168
 G2063    | Qualified nonphysician healthcare professional online assessment and management service, for an established patient, for up to seven days, cumulative time during the 7 days; 21 or more minutes                                                                 |           1014
 99354    | Prolonged office or other outpatient service first hour                                                                                                                                                                                                          |            919
 98967    | Telephone assessment and management service, 11-20 minutes of medical discussion                                                                                                                                                                                 |            839
 96127    | Brief emotional or behavioral assessment                                                                                                                                                                                                                         |            824
 96167    | Health behavior intervention, family (with the patient present), face-to-face; initial 30 minutes                                                                                                                                                                |            585
 99441    | Physician telephone patient service, 5-10 minutes of medical discussion                                                                                                                                                                                          |            491
 99335    | Established patient assisted living visit, typically 25 minutes                                                                                                                                                                                                  |            463
 G9489    | Remote in-home visit for the evaluation and management of an established patient for use only in a medicare-approved coms innovation center demonstration project, which requires at least 2 of the following 3 key components: a comprehensive history; a compr |            458
 99309    | Subsequent nursing facility visit, typically 25 minutes per day                                                                                                                                                                                                  |            439
 99215    | Established patient office or other outpatient, visit typically 40 minutes                                                                                                                                                                                       |            437
 90840    | Psychotherapy for crisis                                                                                                                                                                                                                                         |            434
 99336    | Established patient assisted living visit, typically 40 minutes                                                                                                                                                                                                  |            321
 96146    | Psychological or neuropsychological test administration and scoring by single standardized instrument via electronic platform with automated result                                                                                                              |            320
 96168    | Health behavior intervention, family (with the patient present), face-to-face; each additional 15 minutes                                                                                                                                                        |            288
 90792    | Psychiatric diagnostic evaluation with medical services                                                                                                                                                                                                          |            288
 99442    | Physician telephone patient service, 11-20 minutes of medical discussion                                                                                                                                                                                         |            264
 99214    | Established patient office or other outpatient, visit typically 25 minutes                                                                                                                                                                                       |            261
 G2012    | Brief communication technology-based service, e.g. virtual check-in, by a physician or other qualified health care professional who can report evaluation and management services, provided to an established patient, not originating from a related e/m servic |            212
(50 rows)

